# Settings for instantiating the model architecture/checkpoint behavior.
model: # Model Settings
  model_type: "cond_px_dif" # "cond_px_dif" for conditional diffusion, "px_dif" for unconditional (Depreciated).
  resume_checkpoint: false # false/null starts from scratch; set to a .ckpt path to continue training.
  generated_channels: 3 # Predict 3-band temperature profile target y.
  condition_channels: 5 # EO (1) + corrupted temp channels x (3) + valid mask (1).
  condition_mask_channels: 1 # One valid-mask channel is concatenated to the model condition.
  condition_include_eo: true # Include batch["eo"] as extra condition channel.
  condition_use_valid_mask: true # Use valid_mask as conditioning input in addition to EO + x.
  clamp_known_pixels: false # If true, inpainting-style sampling clamps known pixels each diffusion step for generation stability.
  mask_loss_with_valid_pixels: false # If true, loss is computed only over valid pixels from the mask.
  parameterization: "epsilon" # Diffusion training target: "epsilon" (noise) or "x0" (clean sample).
  log_intermediates: true # Default for validation denoising intermediate logging; training.validation_sampling.log_intermediates overrides this.
  post_process:
    gaussian_blur:
      enabled: true # If true, apply a small Gaussian blur to denormalized predictions at final post-process.
      sigma: 0.5 # Small blur strength (standard deviation in pixels).
      kernel_size: 3 # Odd kernel size; even values are auto-adjusted to the next odd number.

  coord_conditioning:
    enabled: false # Enable patch-center coordinate conditioning via FiLM.
    encoding: "unit_sphere" # "unit_sphere", "sincos", or "raw".
    embed_dim: null # If null, defaults to unet.dim.

  unet: # Denoiser backbone (ConvNeXt U-Net) settings.
    dim: 64 # Base channel width of U-Net.
    dim_mults: [1, 2, 4, 8] # Per-stage width multipliers; length controls U-Net depth.
    with_time_emb: true # Enable timestep embeddings in the denoiser.
    output_mean_scale: false # Optional output mean correction used by some diffusion variants.
    residual: false # If true, predicts a residual added to input.
